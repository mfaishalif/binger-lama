<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Binger - Streaming Movies & TV Shows</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Arial', sans-serif;
    }
    body {
      background-color: #0e161e;
      color: white;
      padding-top: 75px;
    }
    header {
      padding: 20px 50px;
      background-color: #1a242f;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      width: 100%;
      top: 0;
      z-index: 1000;
    }
    nav a {
      color: white;
      text-decoration: none;
      margin-left: 30px;
      font-size: 16px;
    }
    nav a:hover {
      color: #0f79af;
    }
    .hero {
      height: 50vh;
      background: linear-gradient(rgba(15, 23, 30, 0.9), rgba(15, 23, 30, 0.9)),
        url('Banner.jpg') center center no-repeat;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 0 20px;
      background-size: auto;
      background-attachment: local;
    }
    .hero-content {
      max-width: 800px;
    }
    .hero h1 {
      font-size: 48px;
      margin-bottom: 20px;
    }
    .hero p {
      font-size: 24px;
      margin-bottom: 30px;
      color: #8197a4;
    }
    /* Recommended Section Styles */
    .recommended {
      background-color: #1a242f;
      border-radius: 8px;
      margin: 20px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #333;
    }
    .section-header h2 {
      font-size: 24px;
      color: white;
    }
    .tabs-left-group {
      display: flex;
      gap: 20px;
    }
    .tab-btn-left, .tab-btn-right {
      background: none;
      border: none;
      color: #8197a4;
      font-size: 18px;
      cursor: pointer;
      padding: 10px 0;
    }
    .tab-btn-left.active {
      cursor: default;
      color: white !important;
      pointer-events: none;
    }
    .tab-btn-left:hover, .tab-btn-right:hover {
      color: white;
    }
    .pill-toggle {
      display: inline-flex;
      background-color: #333;
      border-radius: 50px;
      overflow: hidden;
      margin-left: 20px;
    }
    .pill-toggle .pill-btn {
      border: none;
      background: transparent;
      padding: 10px 20px;
      color: white;
      cursor: pointer;
      transition: background 0.3s ease;
      font-size: 16px;
    }
    .pill-toggle .pill-btn.active {
      background-color: #F5C418;
      color: #000000;
    }
    .pill-toggle .pill-btn:hover {
      background-color: #d4a716;
      color: #000000;
    }
    .tab-btn-right {
      cursor: pointer;
      color: #8197a4;
    }
    /* Vertical grid layout for the recommended cards */
    .recommended .movie-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
    }
    .movie-card {
      transition: transform 0.3s ease;
      background: #0f171e;
      border-radius: 8px;
      overflow: hidden;
      border: 1px solid #1a242f;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }
    .movie-card:hover {
      transform: translateY(-5px);
    }
    .movie-card img {
      width: 100%;
      height: 300px;
      object-fit: cover;
    }
    .movie-info {
      padding: 15px;
    }
    .movie-info h3 {
      margin: 0 0 8px 0;
      font-size: 16px;
      color: white;
    }
    .movie-info p {
      margin: 0;
      font-size: 14px;
      color: white;
    }
    nav.nav-left {
      display: flex;
      gap: 30px;
    }
    nav.nav-left a {
      margin: 0;
      padding: 0;
    }
    nav.nav-left > * + * {
      margin-left: 30px;
    }
    .nav-left .dropdown {
      position: relative;
    }
    .nav-left .dropdown .dropbtn {
      background: none;
      border: none;
      color: white;
      font-size: 16px;
      cursor: pointer;
      padding: 14px 0;
      font-family: inherit;
    }
    .nav-left .dropdown-content {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      background-color: #1a242f;
      min-width: 160px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
      border-radius: 4px;
      z-index: 1001;
    }
    .nav-left .dropdown-content a {
      display: block;
      padding: 10px 20px;
      color: white;
      text-decoration: none;
      white-space: nowrap;
    }
    .nav-left .dropdown-content a:hover {
      background-color: #333;
    }
    .nav-left .dropdown:hover .dropdown-content {
      display: block;
    }
    nav.nav-left a, .nav-left .dropdown .dropbtn {
      display: flex;
      align-items: center;
      padding: 0;
    }
    nav.nav-right {
      display: flex;
      gap: 30px;
      align-items: center;
    }
    nav.nav-right a:nth-child(2) {
      background-color: #F5C418;
      color: #000000;
      padding: 10px 25px;
      border-radius: 4px;
      transition: all 0.3s ease;
      line-height: 1;
      border: none;
    }
    nav.nav-right a:nth-child(2):hover {
      background-color: #d4a716;
      color: #000000;
    }
    nav.nav-right a:first-child {
      transition: all 0.3s ease;
      padding: 8px 0;
    }
    /* Page switcher styling */
    .page-switcher {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      margin: 20px 0 0;
    }
    .page-switcher button {
      padding: 8px 16px;
      background: #F5C418;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      color: #000;
      transition: background 0.3s;
    }
    .page-switcher button:disabled {
      background: #999;
      cursor: not-allowed;
    }
    /* Additional Styles for Cast & Crew Gallery */
    .cast-crew-section {
      margin-top: 20px;
    }
    .cast-crew-section h2 {
      margin-bottom: 10px;
      font-size: 20px;
    }
    .cast-crew-container {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }
    .cast-card, .crew-card {
      width: 120px;
      text-align: center;
      font-size: 14px;
    }
    .cast-card img, .crew-card img {
      width: 100%;
      border-radius: 4px;
    }
    /* Modal & additional styles remain unchanged */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 2000;
    }
    .modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #1a242f;
      padding: 30px;
      border-radius: 8px;
      z-index: 2100;
      width: 400px;
      max-width: 90%;
    }
    .modal-content {
      color: white;
    }
    .close-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      color: white;
      font-size: 24px;
      cursor: pointer;
    }
    .auth-form {
      margin-top: 20px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group input {
      width: 100%;
      padding: 12px;
      background: #0f171e;
      border: 1px solid #2c3a47;
      border-radius: 4px;
      color: white;
      font-size: 14px;
    }
    .auth-btn {
      width: 100%;
      padding: 12px;
      background: #F5C418;
      color: black;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      margin-top: 10px;
    }
    .auth-switch {
      text-align: center;
      margin-top: 20px;
      color: #8197a4;
    }
    .auth-switch a {
      color: #F5C418;
      text-decoration: none;
      font-weight: bold;
    }
    /* Other modal, info-modal, season-modal, and episode-modal styles remain the same */
    .info-modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 3000;
    }
    .info-modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #1a242f;
      border-radius: 8px;
      padding: 30px;
      width: 80%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      z-index: 3100;
    }
    .info-modal-content {
      display: flex;
      gap: 30px;
      color: white;
    }
    .info-modal-poster {
      flex: 0 0 300px;
    }
    .info-modal-poster img {
      width: 100%;
      border-radius: 8px;
    }
    .info-modal-details {
      flex: 1;
    }
    .info-modal-title {
      font-size: 32px;
      margin-bottom: 15px;
    }
    .info-modal-meta {
      color: #8197a4;
      margin-bottom: 20px;
    }
    .info-modal-overview {
      margin-bottom: 25px;
      line-height: 1.6;
    }
    .info-modal-genres {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }
    .info-modal-genre {
      background: #2c3a47;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 14px;
    }
    .close-info-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      color: white;
      font-size: 24px;
      cursor: pointer;
    }
    .season-modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 3200;
    }
    .season-modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #1a242f;
      border-radius: 8px;
      padding: 30px;
      width: 80%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      z-index: 3300;
    }
    .season-modal h2 {
      margin-bottom: 15px;
    }
    .episode-card {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid #333;
    }
    .episode-card img {
      width: 120px;
      height: 70px;
      object-fit: cover;
      border-radius: 4px;
    }
    .close-season-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      color: white;
      font-size: 24px;
      cursor: pointer;
    }
    .episode-modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 3400;
    }
    .episode-modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #1a242f;
      border-radius: 8px;
      padding: 30px;
      width: 80%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      z-index: 3500;
    }
    .episode-modal-content {
      display: flex;
      gap: 30px;
      color: white;
    }
    .episode-modal-poster {
      flex: 0 0 300px;
    }
    .episode-modal-poster img {
      width: 100%;
      border-radius: 8px;
    }
    .episode-modal-details {
      flex: 1;
    }
    .close-episode-modal {
      position: absolute;
      top: 15px;
      right: 15px;
      color: white;
      font-size: 24px;
      cursor: pointer;
    }
    /* New styles for logged-in profile */
    .profile-menu {
      position: relative;
      display: inline-block;
    }
    
    .profile-circle {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: #F5C418;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    
    .profile-circle:hover {
      transform: scale(1.05);
    }
    
    .profile-circle span {
      color: #000;
      font-weight: bold;
      font-size: 18px;
    }
    
    .profile-dropdown {
      display: none;
      position: absolute;
      right: 0;
      top: 50px;
      background: #1a242f;
      min-width: 200px;
      border-radius: 4px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.3);
      z-index: 1000;
    }
    
    .profile-dropdown.show {
      display: block;
    }
    
    .dropdown-item {
      display: block;
      text-align: left;
      padding: 12px 20px;
      text-decoration: none;
      color: white;
      cursor: pointer;
      margin: 0;
    }
    
    .dropdown-item:hover {
      background: #2c3a47;
    }
    
    .dropdown-item.logout {
      color: white;
      border-top: 1px solid #2c3a47;
    }
    
    .dropdown-item.view-profile {
      color: white;
      border-bottom: 1px solid #2c3a47;
    }
    
    /* Hide login nav when logged in */
    .logged-in .nav-right {
      display: none;
    }
    
    /* Show profile menu when logged in */
    .profile-menu {
      display: none;
    }
    
    .logged-in .profile-menu {
      display: inline-block;
    }
  </style>
</head>
<body>
  <header>
    <nav class="nav-left">
      <a href="#">Binger</a>
      <div class="dropdown">
        <button class="dropbtn">Movies &#9662;</button>
        <div class="dropdown-content">
          <a href="popular.html?type=movie">Popular</a>
          <a href="#">Now Playing</a>
          <a href="#">Upcoming</a>
          <a href="#">Top Rated</a>
          <a href="popular.html?type=movie">Trending</a>
          <a href="#">Genres</a>
        </div>
      </div>
      <div class="dropdown">
        <button class="dropbtn">TV Shows &#9662;</button>
        <div class="dropdown-content">
          <a href="popular.html?type=tv">Popular</a>
          <a href="#">Airing Today</a>
          <a href="#">On The Air</a>
          <a href="#">Top Rated</a>
          <a href="popular.html?type=tv">Trending</a>
          <a href="#">Genres</a>
        </div>
      </div>
      <div class="dropdown">
        <button class="dropbtn">People &#9662;</button>
        <div class="dropdown-content">
          <a href="#">Trending</a>
          <a href="#">Popular</a>
        </div>
      </div>
    </nav>
    <nav class="nav-right">
      <a href="#">Login</a>
      <a href="#">Sign Up</a>
    </nav>
    <div class="profile-menu">
      <div class="profile-circle" id="profileToggle">
        <span>U</span>
      </div>
      <div class="profile-dropdown" id="profileDropdown">
        <a href="user_profile_page.html" class="dropdown-item view-profile">View Profile</a>
        <div class="dropdown-item logout">Log Out</div>
      </div>
    </div>
  </header>

  <div class="hero">
    <div class="hero-content">
      <h1>Welcome.</h1>
      <p>
        Millions of movies, TV shows, and people to discover. Explore now.
      </p>
    </div>
  </div>

<!-- Single Recommended Section -->
<div class="recommended">
  <div class="section-header">
    <h2>Recommended</h2>
    <div class="pill-toggle">
      <button class="pill-btn active">TV Show</button>
      <button class="pill-btn">Movies</button>
    </div>
  </div>
  <!-- Movie/TV cards container (vertical grid layout) -->
  <div class="movie-container">
    <!-- Cards will be dynamically added here -->
  </div>
  <!-- Page Switcher -->
  <div class="page-switcher">
    <button id="prevPage" disabled>Previous</button>
    <span id="currentPage">1</span>
    <button id="nextPage">Next</button>
  </div>
</div>

  <div class="modal-overlay" id="modalOverlay"></div>
  <!-- Sign Up Modal -->
  <div class="modal" id="signupModal">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <h2>Sign Up</h2>
      <p>
        Sign up for a free account to enjoy member benefits: log your movies and TV
        shows, track your favorites for personalized recommendations, build a watchlist,
        and join engaging discussions.
      </p>
      <form class="auth-form">
        <div class="form-group">
          <input type="text" placeholder="Username" required />
        </div>
        <div class="form-group">
          <input type="text" placeholder="Email" required />
        </div>
        <div class="form-group">
          <input type="password" placeholder="Password" required />
        </div>
        <button type="submit" class="auth-btn">Sign Up</button>
      </form>
      <p class="auth-switch">
        Already have a Binger account?
        <a href="#" id="switchToLogin">Log In</a>
      </p>
    </div>
  </div>

  <!-- Login Modal -->
  <div class="modal" id="loginModal">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <h2>Log In</h2>
      <p>
        In order to use the editing and rating capabilities of Binger, as well as get
        personal recommendations you will need to login to your account. If you do not have
        an account, registering for an account is free and simple. Sign Up to get started.
      </p>
      <form class="auth-form">
        <div class="form-group">
          <input type="text" placeholder="Email or username" required />
        </div>
        <div class="form-group">
          <input type="password" placeholder="Password" required />
        </div>
        <button type="submit" class="auth-btn">Log In</button>
      </form>
      <p class="auth-switch">
        Don't have an account?
        <a href="#" id="switchToSignup">Sign Up</a>
      </p>
    </div>
  </div>

  <!-- Info Modal for Movie/TV Details -->
  <div class="info-modal-overlay" id="infoOverlay"></div>
  <div class="info-modal" id="infoModal">
    <span class="close-info-modal">&times;</span>
    <div class="info-modal-content" id="infoContent"></div>
  </div>

  <!-- Season Modal for TV Season Details -->
  <div class="season-modal-overlay" id="seasonOverlay"></div>
  <div class="season-modal" id="seasonModal">
    <span class="close-season-modal">&times;</span>
    <div id="seasonContent"></div>
  </div>

  <div class="episode-modal-overlay" id="episodeOverlay"></div>
  <div class="episode-modal" id="episodeModal">
    <span class="close-episode-modal">&times;</span>
    <div class="episode-modal-content" id="episodeContent"></div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Check if user is logged in (from localStorage)
      const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
      if (isLoggedIn) {
        document.body.classList.add('logged-in');
      }
      
      // ---- MODAL HANDLING (Login/Signup) ----
      const signupButton = document.querySelector("nav.nav-right a:nth-child(2)");
      const loginButton = document.querySelector("nav.nav-right a:first-child");
      const modals = document.querySelectorAll(".modal");
      const overlay = document.getElementById("modalOverlay");
      const closeButtons = document.querySelectorAll(".close-modal");

      function openModal(id) {
        document.getElementById(id).style.display = "block";
        overlay.style.display = "block";
      }

      function closeModals() {
        modals.forEach((m) => (m.style.display = "none"));
        overlay.style.display = "none";
      }

      signupButton.addEventListener("click", (e) => {
        e.preventDefault();
        openModal("signupModal");
      });
      
      loginButton.addEventListener("click", (e) => {
        e.preventDefault();
        openModal("loginModal");
      });
      
      overlay.addEventListener("click", closeModals);
      closeButtons.forEach((btn) => btn.addEventListener("click", closeModals));

      document.getElementById("switchToLogin").addEventListener("click", (e) => {
        e.preventDefault();
        closeModals();
        openModal("loginModal");
      });
      
      document.getElementById("switchToSignup").addEventListener("click", (e) => {
        e.preventDefault();
        closeModals();
        openModal("signupModal");
      });

      // Handle login form submission - bypass authentication
      document.querySelector("#loginModal .auth-form").addEventListener('submit', function(e) {
        e.preventDefault();
        localStorage.setItem('isLoggedIn', 'true');
        document.body.classList.add('logged-in');
        closeModals();
      });
      
      // Handle signup form submission - bypass authentication
      document.querySelector("#signupModal .auth-form").addEventListener('submit', function(e) {
        e.preventDefault();
        localStorage.setItem('isLoggedIn', 'true');
        document.body.classList.add('logged-in');
        closeModals();
      });
      
      // Profile dropdown toggle
      const profileToggle = document.getElementById('profileToggle');
      const profileDropdown = document.getElementById('profileDropdown');
      
      profileToggle.addEventListener('click', (e) => {
        e.stopPropagation();
        profileDropdown.classList.toggle('show');
      });
      
      // Close dropdown when clicking elsewhere
      document.addEventListener('click', (e) => {
        if (!profileDropdown.contains(e.target) && !profileToggle.contains(e.target)) {
          profileDropdown.classList.remove('show');
        }
      });
      
      // Logout functionality
      document.querySelector('.dropdown-item.logout').addEventListener('click', () => {
        localStorage.removeItem('isLoggedIn');
        document.body.classList.remove('logged-in');
      });

      // ---- TMDB FETCH and Info Page Enhancements ----
      const API_KEY = "3939bbef15e0c49e0479e0d747a70d28";
      let recommendedPage = 1; // Track the current page of the Recommended section

      async function fetchItems(endpoint, page = 1) {
        try {
          const res = await fetch(`https://api.themoviedb.org/3/${endpoint}?api_key=${API_KEY}&language=en-US&page=${page}`);
          const data = await res.json();
          return data.results;
        } catch (err) {
          console.error("Error fetching items:", err);
          return [];
        }
      }

      // Display cards with click handlers
    function displayItems(items, selector, isTV = false) {
      const container = document.querySelector(selector);
      container.innerHTML = "";
      items.forEach((item) => {
        const card = document.createElement("div");
        card.className = "movie-card";
        card.innerHTML = `
          <img src="${
            item.poster_path
              ? `https://image.tmdb.org/t/p/w200${item.poster_path}`
              : "https://via.placeholder.com/200x300"
          }" alt="${isTV ? item.name : item.title} poster">
          <div class="movie-info">
            <h3>${isTV ? item.name : item.title}</h3>
            <p>${(isTV ? item.first_air_date : item.release_date || "").split("-")[0] || "N/A"} • ★ ${item.vote_average.toFixed(1)}</p>
          </div>
        `;
        // Redirect to the info page on click
        card.addEventListener("click", () => {
          const mediaType = isTV ? "tv" : "movie";
          window.location.href = `info.html?id=${item.id}&type=${mediaType}`;
        });
        container.appendChild(card);
      });
    }


      // Enhanced media details function with appended credits and cast/crew images
      async function showMediaDetails(id, type) {
        try {
          const response = await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${API_KEY}&language=en-US&append_to_response=credits`);
          const data = await response.json();
          showInfoModal(data, type);
        } catch (error) {
          console.error("Error fetching details:", error);
        }
      }

      // Build the info modal content with cast & crew images
      function showInfoModal(data, type) {
        const infoContent = document.getElementById("infoContent");
        const genreNames = data.genres ? data.genres.map((g) => g.name) : [];
        const cast = data.credits && data.credits.cast ? data.credits.cast.slice(0, 5) : [];
        const crew = data.credits && data.credits.crew ? data.credits.crew.filter((member) => ["Director", "Producer"].includes(member.job)) : [];
        const prodCompanies = data.production_companies && data.production_companies.length ? data.production_companies.map((comp) => comp.name).join(", ") : "N/A";

        let extraInfo = `
          <div style="margin-top: 15px; font-size: 14px;">
            <strong>Status:</strong> ${data.status || "N/A"}<br>
            <strong>Production:</strong> ${prodCompanies}<br>
            ${data.homepage ? `<strong>Homepage:</strong> <a href="${data.homepage}" target="_blank" style="color:#F5C418;">Visit</a><br>` : ""}
          </div>
          <div style="margin-top: 15px;">
            <strong>Cast:</strong>
            <ul>
              ${cast.map((member) => `<li>${member.name} as ${member.character || "N/A"}</li>`).join("")}
            </ul>
            <strong>Crew:</strong>
            <ul>
              ${crew.map((member) => `<li>${member.job}: ${member.name}</li>`).join("")}
            </ul>
          </div>
        `;

        // Build cast and crew image galleries
        let castGallery = "";
        if(cast.length) {
          castGallery = `
            <div class="cast-crew-section">
              <h2>Cast Gallery</h2>
              <div class="cast-crew-container">
                ${cast.map(member => `
                  <div class="cast-card">
                    <img src="${member.profile_path ? `https://image.tmdb.org/t/p/w200${member.profile_path}` : "https://via.placeholder.com/200x300?text=No+Image"}" alt="${member.name}">
                    <p>${member.name}</p>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        }
        let crewGallery = "";
        if(crew.length) {
          crewGallery = `
            <div class="cast-crew-section">
              <h2>Crew Gallery</h2>
              <div class="cast-crew-container">
                ${crew.map(member => `
                  <div class="crew-card">
                    <img src="${member.profile_path ? `https://image.tmdb.org/t/p/w200${member.profile_path}` : "https://via.placeholder.com/200x300?text=No+Image"}" alt="${member.name}">
                    <p>${member.name} (${member.job})</p>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        }

        infoContent.innerHTML = `
          <div class="info-modal-poster">
            <img src="${
              data.poster_path
                ? `https://image.tmdb.org/t/p/w500${data.poster_path}`
                : "https://via.placeholder.com/500x750"
            }" alt="${type === "tv" ? data.name : data.title} poster">
          </div>
          <div class="info-modal-details">
            <h1 class="info-modal-title">${type === "tv" ? data.name : data.title}</h1>
            <div class="info-modal-meta">
              <span>${type === "tv" ? data.first_air_date : data.release_date} • </span>
              <span>★ ${data.vote_average.toFixed(1)} (${data.vote_count} votes) • </span>
              <span>${Math.floor(data.runtime || data.episode_run_time?.[0] || 0)} mins</span>
            </div>
            ${ genreNames.length ? `<div class="info-modal-genres">${genreNames.map((genre) => `<span class="info-modal-genre">${genre}</span>`).join("")}</div>` : "" }
            <p class="info-modal-overview">${data.overview || "No overview available."}</p>
            ${extraInfo}
            ${castGallery}
            ${crewGallery}
          </div>
        `;
        document.getElementById("infoOverlay").style.display = "block";
        document.getElementById("infoModal").style.display = "block";
      }

      // Global function to fetch season details and display episodes
      window.showSeasonDetails = async function(tvId, seasonNumber) {
        try {
          const res = await fetch(`https://api.themoviedb.org/3/tv/${tvId}/season/${seasonNumber}?api_key=${API_KEY}&language=en-US`);
          const data = await res.json();
          let episodesHtml = "";
          if (data.episodes && data.episodes.length) {
            episodesHtml = data.episodes.map((ep) => `
              <div class="episode-card" onclick="showEpisodeDetails(${tvId}, ${seasonNumber}, ${ep.episode_number})" style="cursor:pointer;">
                <img src="${
                  ep.still_path
                    ? `https://image.tmdb.org/t/p/w200${ep.still_path}`
                    : "https://via.placeholder.com/120x70"
                }" alt="${ep.name} cover">
                <div>
                  <strong>${ep.episode_number}. ${ep.name}</strong><br>
                  ★ ${ep.vote_average.toFixed(1)}<br>
                  <small>${ep.air_date || "N/A"}</small>
                  <p style="font-size: 13px;">${ep.overview || "No overview."}</p>
                </div>
              </div>
            `).join("");
          }
          const seasonContent = document.getElementById("seasonContent");
          seasonContent.innerHTML = `
            <h2>${data.name}</h2>
            <div style="margin-bottom:10px;">
              <strong>Air Date:</strong> ${data.air_date || "N/A"}<br>
              <strong>Overview:</strong> ${data.overview || "No overview available."}
            </div>
            <div>
              <strong>Episodes:</strong>
              ${episodesHtml}
            </div>
          `;
          document.getElementById("seasonOverlay").style.display = "block";
          document.getElementById("seasonModal").style.display = "block";
        } catch (error) {
          console.error("Error fetching season details:", error);
        }
      };

      // Global function to fetch and display episode details in the episode modal
      window.showEpisodeDetails = async function(tvId, seasonNumber, episodeNumber) {
        try {
          const res = await fetch(`https://api.themoviedb.org/3/tv/${tvId}/season/${seasonNumber}/episode/${episodeNumber}?api_key=${API_KEY}&language=en-US&append_to_response=credits`);
          const episodeData = await res.json();
          const episodeContent = document.getElementById("episodeContent");
          episodeContent.innerHTML = `
            <div class="episode-modal-poster">
              <img src="${
                episodeData.still_path
                  ? `https://image.tmdb.org/t/p/w500${episodeData.still_path}`
                  : "https://via.placeholder.com/500x281"
              }" alt="${episodeData.name} still">
            </div>
            <div class="episode-modal-details">
              <h1>${episodeData.name}</h1>
              <div style="margin-bottom: 10px;">
                <strong>Episode ${episodeData.episode_number}</strong> | <strong>Air Date:</strong> ${episodeData.air_date || "N/A"}<br>
                <strong>Rating:</strong> ${episodeData.vote_average.toFixed(1)} (based on ${episodeData.vote_count} votes)
              </div>
              <p>${episodeData.overview || "No overview available."}</p>
            </div>
          `;
          document.getElementById("episodeOverlay").style.display = "block";
          document.getElementById("episodeModal").style.display = "block";
        } catch (error) {
          console.error("Error fetching episode details:", error);
        }
      };

      // Close modals event listeners
      document.querySelector(".close-info-modal").addEventListener("click", () => {
        document.getElementById("infoOverlay").style.display = "none";
        document.getElementById("infoModal").style.display = "none";
      });
      document.getElementById("infoOverlay").addEventListener("click", () => {
        document.getElementById("infoOverlay").style.display = "none";
        document.getElementById("infoModal").style.display = "none";
      });
      document.querySelector(".close-season-modal").addEventListener("click", () => {
        document.getElementById("seasonOverlay").style.display = "none";
        document.getElementById("seasonModal").style.display = "none";
      });
      document.getElementById("seasonOverlay").addEventListener("click", () => {
        document.getElementById("seasonOverlay").style.display = "none";
        document.getElementById("seasonModal").style.display = "none";
      });
      document.querySelector(".close-episode-modal").addEventListener("click", () => {
        document.getElementById("episodeOverlay").style.display = "none";
        document.getElementById("episodeModal").style.display = "none";
      });
      document.getElementById("episodeOverlay").addEventListener("click", () => {
        document.getElementById("episodeOverlay").style.display = "none";
        document.getElementById("episodeModal").style.display = "none";
      });

      // ---- Recommended Section Functions ----
      function loadItems(endpoint, selector, isTV, page = 1) {
        fetchItems(endpoint, page).then((results) => displayItems(results, selector, isTV));
      }

      function loadRecommended() {
        const activeToggle = document.querySelector('.recommended .pill-toggle .pill-btn.active');
        const isTV = activeToggle && activeToggle.textContent.toLowerCase().includes("tv");
        const endpoint = isTV ? `tv/popular` : `movie/popular`;
        loadItems(endpoint, ".recommended .movie-container", isTV, recommendedPage);
        // Update the current page display and disable the previous button if on page 1
        document.getElementById("currentPage").textContent = recommendedPage;
        document.getElementById("prevPage").disabled = recommendedPage === 1;
      }
      loadRecommended();

      // Recommended Section Pill Toggle event listener
      document.querySelectorAll(".recommended .pill-toggle").forEach((group) => {
        const buttons = group.querySelectorAll(".pill-btn");
        buttons.forEach((btn) =>
          btn.addEventListener("click", () => {
            buttons.forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            // Reset page to 1 whenever the type changes
            recommendedPage = 1;
            loadRecommended();
          })
        );
      });

      // Pagination switcher event listeners
      document.getElementById("prevPage").addEventListener("click", () => {
        if (recommendedPage > 1) {
          recommendedPage--;
          loadRecommended();
        }
      });
      document.getElementById("nextPage").addEventListener("click", () => {
        recommendedPage++;
        loadRecommended();
      });
    });
  </script>
</body>
</html>
