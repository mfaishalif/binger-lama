<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binger - Ronaldo420's Profile</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background-color: #0e161e;
            color: white;
            padding-top: 80px;
        }

        header {
            padding: 20px 50px;
            background-color: #1a242f;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed; 
            width: 100%;
            top: 0;
            z-index: 1000; 
        }

        nav.nav-right {
            display: none;
        }

        .profile-menu {
            position: relative;
            display: inline-block;
        }

        .profile-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #F5C418;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .profile-circle span {
            color: #000;
            font-weight: bold;
            font-size: 18px;
        }

        .profile-dropdown {
            display: none;
            position: absolute;
            right: 0;
            top: 50px;
            background: #1a242f;
            min-width: 200px;
            border-radius: 4px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            z-index: 1000;
        }

        .profile-dropdown.show {
            display: block;
        }

        .dropdown-item {
            display: block;
            text-align: left;
            padding: 12px 20px;
            margin: 0;
            color: white;
            text-decoration: none;
            cursor: pointer;
        }

        .dropdown-item:hover {
            background: #2c3a47;
        }

        .dropdown-item.logout {
            color: white;
            border-top: 1px solid #2c3a47;
            padding: 12px 20px; 
            margin: 0; 
        }

        .dropdown-item.view-profile {
            color: white;
            border-bottom: 1px solid #2c3a47;
            padding: 12px 20px; 
            margin: 0;     
            text-decoration: none;
        }

        .nav-left {
            display: flex;
            gap: 30px;
        }

        .nav-left a {
            color: white;
            text-decoration: none;
            font-size: 16px;
        }

        /* Add dropdown styles from homepage */
        .nav-left .dropdown {
            position: relative;
        }
        .nav-left .dropdown .dropbtn {
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            padding: 14px 0;
            font-family: inherit;
        }
        .nav-left .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background-color: #1a242f;
            min-width: 160px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            border-radius: 4px;
            z-index: 1001;
        }
        .nav-left .dropdown-content a {
            display: block;
            padding: 10px 20px;
            color: white;
            text-decoration: none;
            white-space: nowrap;
        }
        .nav-left .dropdown-content a:hover {
            background-color: #333;
        }
        .nav-left .dropdown:hover .dropdown-content {
            display: block;
        }
        nav.nav-left a, .nav-left .dropdown .dropbtn {
            display: flex;
            align-items: center;
            padding: 0;
        }

        /* Profile specific styles */
        .profile-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        .profile-info h1 {
            font-size: 36px;
            margin-bottom: 8px;
        }

        .join-date {
            color: #8197a4;
            font-size: 16px;
        }

        .edit-profile-btn {
            background: #F5C418;
            color: #000;
            border: none;
            padding: 12px 30px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: #1a242f;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }

        .content-section {
            background: #1a242f;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .empty-state {
            text-align: center;
            padding: 40px 0;
            color: #8197a4;
        }

        .browse-btn {
            background: #2c3a47;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            margin-top: 15px;
            cursor: pointer;
        }

        .create-btn {
            background: #F5C418;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .create-btn:hover {
            background: #d4a716;
            transform: translateY(-2px);
        }

        .profile-info-section {
            background-color: #1a242f;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #1a242f;
            padding: 25px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        /* Modal Styles */
        .modal, .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
        }

        .modal-content, .modal-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #1a242f;
            padding: 20px;
            border-radius: 8px;
            width: 400px;
            max-width: 90%;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title, .modal-header h2 {
            font-size: 20px;
            color: #F5C418;
        }

        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .modal-body, .form-group {
            margin-bottom: 20px;
        }

        .create-form, #editProfileForm {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .create-form input, 
        .create-form select, 
        #editProfileForm input {
            padding: 12px;
            border: 1px solid #2c3a47;
            border-radius: 4px;
            background-color: #15202b;
            color: white;
            width: 100%;
        }

        .create-form input:focus, 
        .create-form select:focus, 
        #editProfileForm input:focus {
            outline: none;
            border-color: #F5C418;
        }

        .create-form select {
            cursor: pointer;
        }

        .create-form .form-group, #editProfileForm .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .create-form label, #editProfileForm label {
            color: #8197a4;
            display: block;
            margin-bottom: 5px;
        }

        .create-form .form-actions, .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 10px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .modal-footer button {
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .save-btn {
            background-color: #F5C418;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .save-btn:hover {
            background-color: #d4a716;
            transform: translateY(-2px);
        }

        .cancel-btn {
            background-color: #2c3a47;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .cancel-btn:hover {
            background-color: #3d4d5d;
            transform: translateY(-2px);
        }

        .create-form .form-actions button {
            padding: 10px 20px;
            font-weight: bold;
            transition: all 0.3s ease;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .create-form .form-actions .save-btn:hover,
        .create-form .form-actions .cancel-btn:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <header>
        <nav class="nav-left">
            <a href="#">Binger</a>
            <div class="dropdown">
                <button class="dropbtn">Movies &#9662;</button>
                <div class="dropdown-content">
                    <a href="popular.html?type=movie">Popular</a>
                    <a href="#">Now Playing</a>
                    <a href="#">Upcoming</a>
                    <a href="#">Top Rated</a>
                    <a href="popular.html?type=movie">Trending</a>
                    <a href="#">Genres</a>
                </div>
            </div>
            <div class="dropdown">
                <button class="dropbtn">TV Shows &#9662;</button>
                <div class="dropdown-content">
                    <a href="popular.html?type=tv">Popular</a>
                    <a href="#">Airing Today</a>
                    <a href="#">On The Air</a>
                    <a href="#">Top Rated</a>
                    <a href="popular.html?type=tv">Trending</a>
                    <a href="#">Genres</a>
                </div>
            </div>
            <div class="dropdown">
                <button class="dropbtn">People &#9662;</button>
                <div class="dropdown-content">
                    <a href="#">Trending</a>
                    <a href="#">Popular</a>
                </div>
            </div>
        </nav>
        <div class="profile-menu">
            <div class="profile-circle" id="profileToggle">
                <span>U</span>
            </div>
            <div class="profile-dropdown" id="profileDropdown">
                <a href="user_profile_page.html" class="dropdown-item view-profile">View Profile</a>
                <div class="dropdown-item logout">Log Out</div>
            </div>
        </div>
    </header>


    <div class="profile-container">
        <div class="profile-info-section">
            <div class="profile-header">
                <div class="profile-info">
                    <h1>Ronaldo420</h1>
                    <p class="join-date">Joined Mar 2025</p>
                </div>
                <button class="edit-profile-btn" id="editProfileBtn">Edit Profile</button>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <h3>Favourite</h3>
                    <p class="stat-number">0</p>
                </div>
                <div class="stat-card">
                    <h3>Watched</h3>
                    <p class="stat-number">0</p>
                </div>
                <div class="stat-card">
                    <h3>Want to Watch</h3>
                    <p class="stat-number">0</p>
                </div>
                <div class="stat-card">
                    <h3>Collections</h3>
                    <p class="stat-number">0</p>
                </div>
                <div class="stat-card">
                    <h3>Tierlist</h3>
                    <p class="stat-number">0</p>
                </div>
                <div class="stat-card">
                    <h3>Ratings</h3>
                    <p class="stat-number">0</p>
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="section-header">
                <h2>Ratings</h2>
            </div>
            <div id="ratingsContent">
                <div class="empty-state" id="ratingsEmptyState">
                    <p>No ratings yet</p>
                    <button class="browse-btn">Browse popular movies</button>
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="section-header">
                <h2>Collections</h2>
                <button class="create-btn" id="createCollectionBtn">Create Collection</button>
            </div>
            <div id="collectionsContent">
                <div class="empty-state" id="collectionsEmptyState">
                    <p>No Collections yet</p>
                    <button class="browse-btn">Browse popular movies</button>
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="section-header">
                <h2>Favorites</h2>
            </div>
            <div id="favoritesContent">
                <div class="empty-state" id="favoritesEmptyState">
                    <p>No Favorites yet</p>
                    <button class="browse-btn">Browse popular movies</button>
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="section-header">
                <h2>Watched</h2>
            </div>
            <div id="watchedContent">
                <div class="empty-state" id="watchedEmptyState">
                    <p>No Watched yet</p>
                    <button class="browse-btn">Browse popular movies</button>
                </div>
            </div>
        </div>
        
        <div class="content-section">
            <div class="section-header">
                <h2>Want to Watch</h2>
            </div>
            <div id="wantToWatchContent">
                <div class="empty-state" id="wantToWatchEmptyState">
                    <p>No Want to Watch yet</p>
                    <button class="browse-btn">Browse popular movies</button>
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="section-header">
                <h2>Tierlist</h2>
                <button class="create-btn" id="createTierBtn">Create Tierlist</button>
            </div>
            <div id="tierlistContent">
                <div class="empty-state" id="tierlistEmptyState">
                    <p>No Tierlist yet</p>
                    <button class="browse-btn">Browse popular movies</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal-overlay" id="editProfileModal">
        <div class="modal-container">
            <div class="modal-header">
                <h2>Edit Profile</h2>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <form id="editProfileForm">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" value="Ronaldo420" required>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="password">New Password</label>
                    <input type="password" id="password" name="password">
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Current Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword">
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-btn" id="cancelEdit">Cancel</button>
                    <button type="submit" class="save-btn">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Collection Modal -->
    <div id="createCollectionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create Collection</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form class="create-form" id="createCollectionForm">
                    <div class="form-group">
                        <label for="collectionName">Collection Name</label>
                        <input type="text" id="collectionName" placeholder="Enter collection name" required>
                    </div>
                    <div class="form-group">
                        <label for="collectionPrivacy">Privacy Setting</label>
                        <select id="collectionPrivacy" required>
                            <option value="public">Public</option>
                            <option value="private">Private</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="cancel-btn">Cancel</button>
                        <button type="submit" class="save-btn">Create</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Create Tier List Modal -->
    <div id="createTierModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create Tier List</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form class="create-form" id="createTierForm">
                    <div class="form-group">
                        <label for="tierName">Tier List Name</label>
                        <input type="text" id="tierName" placeholder="Enter tier list name" required>
                    </div>
                    <div class="form-group">
                        <label for="tierPrivacy">Privacy Setting</label>
                        <select id="tierPrivacy" required>
                            <option value="public">Public</option>
                            <option value="private">Private</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="cancel-btn">Cancel</button>
                        <button type="submit" class="save-btn">Create</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        const profileToggle = document.getElementById('profileToggle');
        const profileDropdown = document.getElementById('profileDropdown');

        profileToggle.addEventListener('click', (e) => {
            e.stopPropagation();
            profileDropdown.classList.toggle('show');
        });

        document.addEventListener('click', (e) => {
            if (!profileDropdown.contains(e.target) && !profileToggle.contains(e.target)) {
                profileDropdown.classList.remove('show');
            }
        });

        document.querySelector('.logout').addEventListener('click', () => {
            localStorage.removeItem('isLoggedIn');
            window.location.href = 'homepage.html';
        });

        // Modal functionality
        const editProfileBtn = document.getElementById('editProfileBtn');
        const editProfileModal = document.getElementById('editProfileModal');
        const closeModal = document.getElementById('closeModal');
        const cancelEdit = document.getElementById('cancelEdit');
        const editProfileForm = document.getElementById('editProfileForm');

        function openEditModal() {
            editProfileModal.style.display = 'block';
        }

        function closeEditModalHandler() {
            editProfileModal.style.display = 'none';
        }

        editProfileBtn.addEventListener('click', openEditModal);
        closeModal.addEventListener('click', closeEditModalHandler);
        cancelEdit.addEventListener('click', closeEditModalHandler);

        // Close edit modal when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === editProfileModal) {
                closeEditModalHandler();
            }
        });

        // Form submission for edit profile
        editProfileForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            // Here you would typically validate the current password
            // and update the profile information

            closeEditModalHandler();
            alert('Profile updated successfully!');
        });

        // Collection and Tier List Modal Functionality
        const createCollectionBtn = document.getElementById('createCollectionBtn');
        const createTierBtn = document.getElementById('createTierBtn');
        const createCollectionModal = document.getElementById('createCollectionModal');
        const createTierModal = document.getElementById('createTierModal');
        const createCollectionForm = document.getElementById('createCollectionForm');
        const createTierForm = document.getElementById('createTierForm');

        function showModal(modal) {
            modal.style.display = 'block';
        }

        function hideModal(modal) {
            modal.style.display = 'none';
        }

        // Show modals
        createCollectionBtn.addEventListener('click', () => showModal(createCollectionModal));
        createTierBtn.addEventListener('click', () => showModal(createTierModal));

        // Close modals
        document.querySelectorAll('.close-modal').forEach(btn => {
            btn.addEventListener('click', () => {
                hideModal(createCollectionModal);
                hideModal(createTierModal);
            });
        });

        // Close modals when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === createCollectionModal) hideModal(createCollectionModal);
            if (e.target === createTierModal) hideModal(createTierModal);
        });

        // Form submissions
        createCollectionForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('collectionName').value.trim();
            const privacy = document.getElementById('collectionPrivacy').value;
            
            if (name) {
                const collections = JSON.parse(localStorage.getItem('collections') || '{}');
                if (!collections[name]) {
                    collections[name] = {
                        items: [],
                        privacy: privacy
                    };
                    localStorage.setItem('collections', JSON.stringify(collections));
                    hideModal(createCollectionModal);
                    createCollectionForm.reset();
                    
                    // Refresh the collections display
                    const collectionsContent = document.getElementById('collectionsContent');
                    const collectionsEmptyState = document.getElementById('collectionsEmptyState');
                    collectionsContent.innerHTML = '';
                    collectionsContent.appendChild(collectionsEmptyState);
                    updateCollectionsContent(collections, collectionsContent, collectionsEmptyState);
                    
                    // Update stats
                    const statElements = document.querySelectorAll('.stat-number');
                    if (statElements.length >= 6) {
                        statElements[3].textContent = Object.keys(collections).length; // Collections count
                    }
                    
                    alert('Collection created successfully!');
                } else {
                    alert('A collection with this name already exists!');
                }
            }
        });

        createTierForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('tierName').value.trim();
            const privacy = document.getElementById('tierPrivacy').value;
            
            if (name) {
                const tiers = JSON.parse(localStorage.getItem('tierlist') || '{}');
                if (!tiers[name]) {
                    tiers[name] = {
                        items: [],
                        privacy: privacy
                    };
                    localStorage.setItem('tierlist', JSON.stringify(tiers));
                    hideModal(createTierModal);
                    createTierForm.reset();
                    alert('Tier list created successfully!');
                } else {
                    alert('A tier list with this name already exists!');
                }
            }
        });

        // Cancel buttons
        document.querySelectorAll('.cancel-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                hideModal(createCollectionModal);
                hideModal(createTierModal);
            });
        });

        // Load and display watched and want to watch content
        function loadWatchedContent() {
            const watchedContent = document.getElementById('watchedContent');
            const watchedEmptyState = document.getElementById('watchedEmptyState');
            const wantToWatchContent = document.getElementById('wantToWatchContent');
            const wantToWatchEmptyState = document.getElementById('wantToWatchEmptyState');
            const favoritesContent = document.getElementById('favoritesContent');
            const favoritesEmptyState = document.getElementById('favoritesEmptyState');
            const collectionsContent = document.getElementById('collectionsContent');
            const collectionsEmptyState = document.getElementById('collectionsEmptyState');
            const ratingsContent = document.getElementById('ratingsContent');
            const ratingsEmptyState = document.getElementById('ratingsEmptyState');
            
            // Get statuses from localStorage
            const statuses = JSON.parse(localStorage.getItem('statuses') || '{}');
            
            // Get favorites from localStorage
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            
            // Get collections from localStorage
            const collections = JSON.parse(localStorage.getItem('collections') || '{}');
            
            // Get ratings from localStorage
            const ratings = JSON.parse(localStorage.getItem('ratings') || '{}');
            
            // Get tierlists from localStorage
            const tierlists = JSON.parse(localStorage.getItem('tierlist') || '{}');
            
            // Filter for watched and want to watch
            const watchedItems = [];
            const wantToWatchItems = [];
            
            // Process the statuses
            for (const key in statuses) {
                if (statuses[key] === 'watched') {
                    watchedItems.push(key);
                } else if (statuses[key] === 'want-to-watch') {
                    wantToWatchItems.push(key);
                }
            }
            
            // Update content and counts
            updateStatusContent(watchedItems, watchedContent, watchedEmptyState);
            updateStatusContent(wantToWatchItems, wantToWatchContent, wantToWatchEmptyState);
            
            // Update favorites content
            updateFavoritesContent(favorites, favoritesContent, favoritesEmptyState);
            
            // Update collections content
            updateCollectionsContent(collections, collectionsContent, collectionsEmptyState);
            
            // Update ratings content
            updateRatingsContent(ratings, ratingsContent, ratingsEmptyState);
            
            // Update tierlist content
            updateTierlistContent(tierlists, document.getElementById('tierlistContent'), document.getElementById('tierlistEmptyState'));
            
            // Update stats
            const statElements = document.querySelectorAll('.stat-number');
            if (statElements.length >= 6) {
                statElements[0].textContent = favorites.length; // Favorites count
                statElements[1].textContent = watchedItems.length; // Watched count
                statElements[2].textContent = wantToWatchItems.length; // Want to Watch count
                statElements[3].textContent = Object.keys(collections).length; // Collections count
                statElements[4].textContent = Object.keys(tierlists).length; // Tierlist count
                statElements[5].textContent = Object.keys(ratings).length; // Ratings count
            }
        }
        
        function updateStatusContent(items, container, emptyState) {
            if (items.length === 0) {
                // Show empty state
                emptyState.style.display = 'block';
                return;
            }
            
            // Hide empty state
            emptyState.style.display = 'none';
            
            // Create grid for media items
            const gridContainer = document.createElement('div');
            gridContainer.className = 'media-grid';
            gridContainer.style.display = 'grid';
            gridContainer.style.gridTemplateColumns = 'repeat(auto-fill, minmax(150px, 1fr))';
            gridContainer.style.gap = '20px';
            gridContainer.style.padding = '20px 0';
            
            // Add each item to the grid
            items.forEach(key => {
                const [type, id] = key.split('_');
                
                // Create media card
                const card = document.createElement('div');
                card.className = 'media-card';
                card.style.background = '#2c3a47';
                card.style.borderRadius = '8px';
                card.style.overflow = 'hidden';
                card.style.transition = 'transform 0.3s ease';
                card.style.cursor = 'pointer';
                card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
                
                // Create hover effect
                card.style.transition = 'all 0.3s ease';
                card.addEventListener('mouseenter', () => {
                    card.style.transform = 'translateY(-5px)';
                    card.style.boxShadow = '0 8px 16px rgba(0,0,0,0.3)';
                });
                card.addEventListener('mouseleave', () => {
                    card.style.transform = '';
                    card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
                });
                
                // Get title from localStorage if available
                let title = 'Unknown Title';
                
                // Try to get it from favorites, collections, or tierlists
                const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
                const favItem = favorites.find(item => item.key === key);
                if (favItem && favItem.title) {
                    title = favItem.title;
                }
                
                // Create initial content with loading state
                card.innerHTML = `
                    <div class="media-poster" style="height: 225px; background: #1a242f; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 36px; color: #8197a4;">Loading...</span>
                    </div>
                    <div class="media-info" style="padding: 10px;">
                        <h3 style="font-size: 14px; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${title}</h3>
                        <p style="font-size: 12px; color: #8197a4;">${type === 'movie' ? 'Movie' : 'TV Show'}</p>
                    </div>
                `;
                
                // Add click event to navigate to info page
                card.addEventListener('click', () => {
                    window.location.href = `info.html?id=${id}&type=${type}`;
                });
                
                // Add to grid
                gridContainer.appendChild(card);
                
                // Fetch poster from API
                fetchPoster(type, id, card);
            });
            
            // Add grid to container
            container.appendChild(gridContainer);
        }
        
        function updateFavoritesContent(favorites, container, emptyState) {
            if (favorites.length === 0) {
                // Show empty state
                emptyState.style.display = 'block';
                return;
            }
            
            // Hide empty state
            emptyState.style.display = 'none';
            
            // Create grid for media items
            const gridContainer = document.createElement('div');
            gridContainer.className = 'media-grid';
            gridContainer.style.display = 'grid';
            gridContainer.style.gridTemplateColumns = 'repeat(auto-fill, minmax(150px, 1fr))';
            gridContainer.style.gap = '20px';
            gridContainer.style.padding = '20px 0';
            
            // Add each item to the grid
            favorites.forEach(item => {
                const { key, title, type, id } = item;
                
                // Create media card
                const card = document.createElement('div');
                card.className = 'media-card';
                card.style.background = '#2c3a47';
                card.style.borderRadius = '8px';
                card.style.overflow = 'hidden';
                card.style.transition = 'transform 0.3s ease';
                card.style.cursor = 'pointer';
                card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
                
                // Create hover effect
                card.style.transition = 'all 0.3s ease';
                card.addEventListener('mouseenter', () => {
                    card.style.transform = 'translateY(-5px)';
                    card.style.boxShadow = '0 8px 16px rgba(0,0,0,0.3)';
                });
                card.addEventListener('mouseleave', () => {
                    card.style.transform = '';
                    card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
                });
                
                // Create initial content with loading state
                card.innerHTML = `
                    <div class="media-poster" style="height: 225px; background: #1a242f; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 36px; color: #8197a4;">Loading...</span>
                    </div>
                    <div class="media-info" style="padding: 10px;">
                        <h3 style="font-size: 14px; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${title}</h3>
                        <p style="font-size: 12px; color: #8197a4;">${type === 'movie' ? 'Movie' : 'TV Show'}</p>
                    </div>
                `;
                
                // Add click event to navigate to info page
                card.addEventListener('click', () => {
                    window.location.href = `info.html?id=${id}&type=${type}`;
                });
                
                // Add to grid
                gridContainer.appendChild(card);
                
                // Fetch poster from API
                fetchPoster(type, id, card);
            });
            
            // Add grid to container
            container.appendChild(gridContainer);
        }
        
        function updateCollectionsContent(collections, container, emptyState) {
            const collectionNames = Object.keys(collections);
            
            if (collectionNames.length === 0) {
                // Show empty state
                emptyState.style.display = 'block';
                return;
            }
            
            // Hide empty state
            emptyState.style.display = 'none';
            
            // Create container for collections
            const collectionsContainer = document.createElement('div');
            collectionsContainer.style.display = 'flex';
            collectionsContainer.style.flexDirection = 'column';
            collectionsContainer.style.gap = '30px';
            collectionsContainer.style.padding = '20px 0';
            
            // Add each collection
            collectionNames.forEach(collectionName => {
                const collection = collections[collectionName];
                const collectionItems = collection.items || [];
                
                // Create collection section
                const collectionSection = document.createElement('div');
                collectionSection.className = 'collection-section';
                collectionSection.style.marginBottom = '30px';
                
                // Collection header
                const collectionHeader = document.createElement('div');
                collectionHeader.style.display = 'flex';
                collectionHeader.style.justifyContent = 'space-between';
                collectionHeader.style.alignItems = 'center';
                collectionHeader.style.marginBottom = '15px';
                collectionHeader.style.paddingLeft = '10px';
                collectionHeader.style.borderLeft = '4px solid #F5C418';
                
                const collectionTitle = document.createElement('h3');
                collectionTitle.textContent = collectionName;
                collectionTitle.style.fontSize = '18px';
                collectionTitle.style.color = '#F5C418';
                
                const privacyBadge = document.createElement('span');
                privacyBadge.textContent = collection.privacy || 'public';
                privacyBadge.style.fontSize = '12px';
                privacyBadge.style.padding = '3px 8px';
                privacyBadge.style.borderRadius = '12px';
                privacyBadge.style.backgroundColor = collection.privacy === 'private' ? '#2c3a47' : '#3a506b';
                
                const removeBtn = document.createElement('button');
                removeBtn.textContent = 'Remove';
                removeBtn.style.backgroundColor = '#f44336';
                removeBtn.style.color = 'white';
                removeBtn.style.border = 'none';
                removeBtn.style.padding = '5px 10px';
                removeBtn.style.borderRadius = '4px';
                removeBtn.style.cursor = 'pointer';
                removeBtn.style.marginLeft = '10px';
                
                // Add hover effect to remove button
                removeBtn.addEventListener('mouseenter', () => {
                    removeBtn.style.backgroundColor = '#d32f2f';
                });
                removeBtn.addEventListener('mouseleave', () => {
                    removeBtn.style.backgroundColor = '#f44336';
                });
                
                // Add click event to remove collection
                removeBtn.addEventListener('click', (e) => {
                    e.stopPropagation(); // Prevent event bubbling
                    
                    // Confirm before deleting
                    if (confirm(`Are you sure you want to delete the collection "${collectionName}"?`)) {
                        // Remove collection from localStorage
                        delete collections[collectionName];
                        localStorage.setItem('collections', JSON.stringify(collections));
                        
                        // Remove collection section from UI
                        collectionSection.remove();
                        
                        // Update stats counter
                        const statElements = document.querySelectorAll('.stat-number');
                        if (statElements.length >= 4) {
                            statElements[3].textContent = Object.keys(collections).length; // Collections count
                        }
                        
                        // If no collections left, show empty state
                        if (Object.keys(collections).length === 0) {
                            emptyState.style.display = 'block';
                        }
                    }
                });
                
                // Create a div for the buttons/controls
                const collectionControls = document.createElement('div');
                collectionControls.style.display = 'flex';
                collectionControls.style.alignItems = 'center';
                collectionControls.style.gap = '10px';
                
                collectionControls.appendChild(privacyBadge);
                collectionControls.appendChild(removeBtn);
                
                collectionHeader.appendChild(collectionTitle);
                collectionHeader.appendChild(collectionControls);
                collectionSection.appendChild(collectionHeader);
                
                // If no items, show empty message
                if (collectionItems.length === 0) {
                    const emptyMessage = document.createElement('p');
                    emptyMessage.textContent = 'No items in this collection';
                    emptyMessage.style.color = '#8197a4';
                    emptyMessage.style.textAlign = 'center';
                    emptyMessage.style.padding = '20px';
                    collectionSection.appendChild(emptyMessage);
                } else {
                    // Create grid for collection items
                    const itemsGrid = document.createElement('div');
                    itemsGrid.className = 'collection-items-grid';
                    itemsGrid.style.display = 'grid';
                    itemsGrid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(150px, 1fr))';
                    itemsGrid.style.gap = '20px';
                    
                    // Add each item to the grid
                    collectionItems.forEach(item => {
                        const { key, title, type, id } = item;
                        
                        // Create media card
                        const card = document.createElement('div');
                        card.className = 'media-card';
                        card.style.background = '#2c3a47';
                        card.style.borderRadius = '8px';
                        card.style.overflow = 'hidden';
                        card.style.transition = 'all 0.3s ease';
                        card.style.cursor = 'pointer';
                        card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
                        
                        // Create hover effect
                        card.addEventListener('mouseenter', () => {
                            card.style.transform = 'translateY(-5px)';
                            card.style.boxShadow = '0 8px 16px rgba(0,0,0,0.3)';
                        });
                        card.addEventListener('mouseleave', () => {
                            card.style.transform = '';
                            card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
                        });
                        
                        // Create initial content with loading state
                        card.innerHTML = `
                            <div class="media-poster" style="height: 225px; background: #1a242f; display: flex; align-items: center; justify-content: center;">
                                <span style="font-size: 36px; color: #8197a4;">Loading...</span>
                            </div>
                            <div class="media-info" style="padding: 10px;">
                                <h3 style="font-size: 14px; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${title}</h3>
                                <p style="font-size: 12px; color: #8197a4;">${type === 'movie' ? 'Movie' : 'TV Show'}</p>
                            </div>
                        `;
                        
                        // Add click event to navigate to info page
                        card.addEventListener('click', () => {
                            window.location.href = `info.html?id=${id}&type=${type}`;
                        });
                        
                        // Add to grid
                        itemsGrid.appendChild(card);
                        
                        // Fetch poster from API
                        fetchPoster(type, id, card);
                    });
                    
                    collectionSection.appendChild(itemsGrid);
                }
                
                // Add the collection section to the collections container
                collectionsContainer.appendChild(collectionSection);
            });
            
            // Add collections container to the main container
            container.appendChild(collectionsContainer);
        }
        
        function updateRatingsContent(ratings, container, emptyState) {
            const ratedItems = Object.entries(ratings).map(([key, rating]) => {
                const [type, id] = key.split('_');
                return { key, rating, type, id };
            });
            
            if (ratedItems.length === 0) {
                // Show empty state
                emptyState.style.display = 'block';
                return;
            }
            
            // Hide empty state
            emptyState.style.display = 'none';
            
            // Create grid for media items
            const gridContainer = document.createElement('div');
            gridContainer.className = 'media-grid';
            gridContainer.style.display = 'grid';
            gridContainer.style.gridTemplateColumns = 'repeat(auto-fill, minmax(150px, 1fr))';
            gridContainer.style.gap = '20px';
            gridContainer.style.padding = '20px 0';
            
            // Add each item to the grid
            ratedItems.forEach(item => {
                const { key, rating, type, id } = item;
                
                // Create media card
                const card = document.createElement('div');
                card.className = 'media-card';
                card.style.background = '#2c3a47';
                card.style.borderRadius = '8px';
                card.style.overflow = 'hidden';
                card.style.transition = 'transform 0.3s ease';
                card.style.cursor = 'pointer';
                card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
                
                // Create hover effect
                card.style.transition = 'all 0.3s ease';
                card.addEventListener('mouseenter', () => {
                    card.style.transform = 'translateY(-5px)';
                    card.style.boxShadow = '0 8px 16px rgba(0,0,0,0.3)';
                });
                card.addEventListener('mouseleave', () => {
                    card.style.transform = '';
                    card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
                });
                
                // Get title from localStorage if available
                let title = 'Unknown Title';
                
                // Try to get it from favorites, collections, or tierlists
                const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
                const favItem = favorites.find(item => item.key === key);
                if (favItem && favItem.title) {
                    title = favItem.title;
                }
                
                // Create initial content with loading state
                card.innerHTML = `
                    <div class="media-poster" style="height: 225px; background: #1a242f; display: flex; align-items: center; justify-content: center;">
                        <span style="font-size: 36px; color: #8197a4;">Loading...</span>
                    </div>
                    <div class="media-info" style="padding: 10px;">
                        <h3 style="font-size: 14px; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${title}</h3>
                        <p style="font-size: 12px; color: #8197a4;">${type === 'movie' ? 'Movie' : 'TV Show'}</p>
                        <p style="font-size: 16px; color: #F5C418; margin-top: 5px;">Rating: ${rating}/10</p>
                    </div>
                `;
                
                // Add click event to navigate to info page
                card.addEventListener('click', () => {
                    window.location.href = `info.html?id=${id}&type=${type}`;
                });
                
                // Add to grid
                gridContainer.appendChild(card);
                
                // Fetch poster from API
                fetchPoster(type, id, card);
            });
            
            // Add grid to container
            container.appendChild(gridContainer);
        }
        
        // New function to update tierlist content
        function updateTierlistContent(tierlists, container, emptyState) {
            const tierlistNames = Object.keys(tierlists);
            
            if (tierlistNames.length === 0) {
                // Show empty state
                emptyState.style.display = 'block';
                return;
            }
            
            // Hide empty state
            emptyState.style.display = 'none';
            
            // Create container for tierlists
            const tierlistsContainer = document.createElement('div');
            tierlistsContainer.style.display = 'flex';
            tierlistsContainer.style.flexDirection = 'column';
            tierlistsContainer.style.gap = '30px';
            tierlistsContainer.style.padding = '20px 0';
            
            // Add each tierlist
            tierlistNames.forEach(tierlistName => {
                const tierlist = tierlists[tierlistName];
                const tierlistItems = tierlist.items || [];
                
                // Create tierlist section
                const tierlistSection = document.createElement('div');
                tierlistSection.className = 'tierlist-section';
                tierlistSection.style.marginBottom = '30px';
                
                // Tierlist header
                const tierlistHeader = document.createElement('div');
                tierlistHeader.style.display = 'flex';
                tierlistHeader.style.justifyContent = 'space-between';
                tierlistHeader.style.alignItems = 'center';
                tierlistHeader.style.marginBottom = '15px';
                tierlistHeader.style.paddingLeft = '10px';
                tierlistHeader.style.borderLeft = '4px solid #F5C418';
                
                const tierlistTitle = document.createElement('h3');
                tierlistTitle.textContent = tierlistName;
                tierlistTitle.style.fontSize = '18px';
                tierlistTitle.style.color = '#F5C418';
                
                const privacyBadge = document.createElement('span');
                privacyBadge.textContent = tierlist.privacy || 'public';
                privacyBadge.style.fontSize = '12px';
                privacyBadge.style.padding = '3px 8px';
                privacyBadge.style.borderRadius = '12px';
                privacyBadge.style.backgroundColor = tierlist.privacy === 'private' ? '#2c3a47' : '#3a506b';
                
                const removeBtn = document.createElement('button');
                removeBtn.textContent = 'Remove';
                removeBtn.style.backgroundColor = '#f44336';
                removeBtn.style.color = 'white';
                removeBtn.style.border = 'none';
                removeBtn.style.padding = '5px 10px';
                removeBtn.style.borderRadius = '4px';
                removeBtn.style.cursor = 'pointer';
                removeBtn.style.marginLeft = '10px';
                
                // Add hover effect to remove button
                removeBtn.addEventListener('mouseenter', () => {
                    removeBtn.style.backgroundColor = '#d32f2f';
                });
                removeBtn.addEventListener('mouseleave', () => {
                    removeBtn.style.backgroundColor = '#f44336';
                });
                
                // Add click event to remove tierlist
                removeBtn.addEventListener('click', (e) => {
                    e.stopPropagation(); // Prevent event bubbling
                    
                    // Confirm before deleting
                    if (confirm(`Are you sure you want to delete the tierlist "${tierlistName}"?`)) {
                        // Remove tierlist from localStorage
                        delete tierlists[tierlistName];
                        localStorage.setItem('tierlist', JSON.stringify(tierlists));
                        
                        // Remove tierlist section from UI
                        tierlistSection.remove();
                        
                        // Update stats counter
                        const statElements = document.querySelectorAll('.stat-number');
                        if (statElements.length >= 5) {
                            statElements[4].textContent = Object.keys(tierlists).length; // Tierlists count
                        }
                        
                        // If no tierlists left, show empty state
                        if (Object.keys(tierlists).length === 0) {
                            emptyState.style.display = 'block';
                        }
                    }
                });
                
                // Create a div for the buttons/controls
                const tierlistControls = document.createElement('div');
                tierlistControls.style.display = 'flex';
                tierlistControls.style.alignItems = 'center';
                tierlistControls.style.gap = '10px';
                
                tierlistControls.appendChild(privacyBadge);
                tierlistControls.appendChild(removeBtn);
                
                tierlistHeader.appendChild(tierlistTitle);
                tierlistHeader.appendChild(tierlistControls);
                tierlistSection.appendChild(tierlistHeader);
                
                // If no items, show empty message
                if (tierlistItems.length === 0) {
                    const emptyMessage = document.createElement('p');
                    emptyMessage.textContent = 'No items in this tierlist';
                    emptyMessage.style.color = '#8197a4';
                    emptyMessage.style.textAlign = 'center';
                    emptyMessage.style.padding = '20px';
                    tierlistSection.appendChild(emptyMessage);
                } else {
                    // Create grid for tierlist items
                    const itemsGrid = document.createElement('div');
                    itemsGrid.className = 'tierlist-items-grid';
                    itemsGrid.style.display = 'grid';
                    itemsGrid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(150px, 1fr))';
                    itemsGrid.style.gap = '20px';
                    
                    // Add each item to the grid
                    tierlistItems.forEach(item => {
                        const { key, title, type, id } = item;
                        
                        // Create media card
                        const card = document.createElement('div');
                        card.className = 'media-card';
                        card.style.background = '#2c3a47';
                        card.style.borderRadius = '8px';
                        card.style.overflow = 'hidden';
                        card.style.transition = 'all 0.3s ease';
                        card.style.cursor = 'pointer';
                        card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
                        
                        // Create hover effect
                        card.addEventListener('mouseenter', () => {
                            card.style.transform = 'translateY(-5px)';
                            card.style.boxShadow = '0 8px 16px rgba(0,0,0,0.3)';
                        });
                        card.addEventListener('mouseleave', () => {
                            card.style.transform = '';
                            card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
                        });
                        
                        // Create initial content with loading state
                        card.innerHTML = `
                            <div class="media-poster" style="height: 225px; background: #1a242f; display: flex; align-items: center; justify-content: center;">
                                <span style="font-size: 36px; color: #8197a4;">Loading...</span>
                            </div>
                            <div class="media-info" style="padding: 10px;">
                                <h3 style="font-size: 14px; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${title}</h3>
                                <p style="font-size: 12px; color: #8197a4;">${type === 'movie' ? 'Movie' : 'TV Show'}</p>
                            </div>
                        `;
                        
                        // Add click event to navigate to info page
                        card.addEventListener('click', () => {
                            window.location.href = `info.html?id=${id}&type=${type}`;
                        });
                        
                        // Add to grid
                        itemsGrid.appendChild(card);
                        
                        // Fetch poster from API
                        fetchPoster(type, id, card);
                    });
                    
                    tierlistSection.appendChild(itemsGrid);
                }
                
                // Add the tierlist section to the tierlists container
                tierlistsContainer.appendChild(tierlistSection);
            });
            
            // Add tierlists container to the main container
            container.appendChild(tierlistsContainer);
        }
        
        // Function to fetch poster from TMDB API
        function fetchPoster(type, id, cardElement) {
            const API_KEY = "3939bbef15e0c49e0479e0d747a70d28";
            
            fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${API_KEY}&language=en-US`)
                .then(response => response.json())
                .then(data => {
                    const posterPath = data.poster_path;
                    const posterElement = cardElement.querySelector('.media-poster');
                    
                    if (posterPath) {
                        // Update with actual poster
                        posterElement.innerHTML = `<img src="https://image.tmdb.org/t/p/w300${posterPath}" alt="${data.title || data.name}" style="width:100%; height:100%; object-fit:cover;">`;
                    } else {
                        // Fallback if no poster available
                        posterElement.innerHTML = `<span style="font-size: 36px; color: #8197a4;">🎬</span>`;
                    }
                    
                    // Update title if we have more accurate info
                    const titleElement = cardElement.querySelector('.media-info h3');
                    if (data.title || data.name) {
                        titleElement.textContent = data.title || data.name;
                    }
                })
                .catch(error => {
                    console.error('Error fetching poster:', error);
                    // Show fallback on error
                    const posterElement = cardElement.querySelector('.media-poster');
                    posterElement.innerHTML = `<span style="font-size: 36px; color: #8197a4;">🎬</span>`;
                });
        }
        
        // Load content when page loads
        window.addEventListener('DOMContentLoaded', () => {
            loadWatchedContent();
        });
    </script>
</body>
</html>